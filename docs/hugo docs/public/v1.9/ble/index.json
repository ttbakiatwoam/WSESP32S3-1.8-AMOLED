[{"content":"Discover nearby BLE devices and gather information about them.\nWi-Fi impact: Starting any BLE scan temporarily suspends the GhostNet access point. Wi-Fi services resume automatically once you stop scanning (for example by running stop or pressing Back in the UI).\nPrerequisites\rGhostESP flashed device, powered on with a wireless antenna. Device must support Bluetooth (not available on ESP32-S2). Scanning for devices\rOn-device UI\rOpen Menu → Bluetooth. Choose a scanning mode from the options below. The device will start scanning. Leave it running until you have enough data. Back out of the terminal view to stop scanning. The device will show a summary of discovered devices. Command line\rOpen the GhostESP terminal. Run blescan [OPTION] where the option is one of the modes below (for example, blescan -f). The device will start scanning. Run blescan -s when you\u0026rsquo;re done. The device will stop scanning and show a summary. Scanning modes\rFind Flippers\rUI: Menu → Bluetooth → Find Flippers CLI: blescan -f Scans for nearby Flipper Zero devices and displays their names and signal strength. After scanning, use Select Flipper to track a specific device\u0026rsquo;s RSSI (signal strength) in real time as you move around. AirTag Scanner\rUI: Menu → Bluetooth → Start AirTag Scanner CLI: blescan -a Scans for Apple AirTags and other Find My devices using active scanning to find more devices. Allows duplicate advertisements to be reported for better tracking. While scanning, RSSI for already discovered AirTags is logged every few seconds to help you see proximity changes over time. Use List AirTags to see discovered devices, or Select AirTag to prepare for spoofing. BLE Skimmer Detection\rUI: Menu → Bluetooth → BLE Skimmer Detect CLI: capture -skimmer Scans for payment terminal skimmers that use BLE to exfiltrate card data. Logs detected skimmers to a PCAP file for analysis. GATT Service Enumeration\rUI: Menu → Bluetooth → GATT Scan → Start GATT Scan CLI: blescan -g Connect to BLE devices and discover what services they offer (e.g., heart rate, battery level, custom services). Track devices by signal strength to physically locate them. See the dedicated GATT Discovery page for a full walkthrough, command reference, and service UUID tables.\nListing and selecting devices\rAfter scanning, you can interact with discovered devices:\nList discovered devices\rFlippers: Menu → Bluetooth → Flipper → List Flippers or CLI: listflippers AirTags: Menu → Bluetooth → AirTag → List AirTags or CLI: listairtags GATT Devices: Menu → Bluetooth → GATT Scan → List GATT Devices or CLI: listgatt Select a device for further action\rFlipper: Menu → Bluetooth → Flipper → Select Flipper Once selected, the device will continuously track and display the Flipper\u0026rsquo;s RSSI (signal strength). Use this to locate the Flipper by moving around and watching the signal strength change. AirTag: Menu → Bluetooth → AirTag → Select AirTag (prepares for spoofing) GATT Device: Menu → Bluetooth → GATT Scan → Select GATT Device Once selected, use Enumerate Services to connect and discover the device\u0026rsquo;s GATT services. Use Track Device to locate it using real-time signal strength updates. Notes\rBLE scanning is not available on ESP32-S2 devices. Scanning modes are mutually exclusive; starting a new scan will stop the previous one. Signal strength (RSSI) is displayed in dBm; higher values (closer to 0) indicate stronger signals. Some devices may not respond to all scanning modes depending on their BLE implementation. Troubleshooting\rNo devices found: Move closer to BLE devices and try scanning again. Scanning stops immediately: Check that your device has Bluetooth enabled. Remember that the AP pauses during scans—wait a moment after stopping for Wi-Fi to return. Device not responding: Some devices may be in sleep mode or have BLE disabled. Try scanning again or move closer. Bluetooth not supported: Ensure you\u0026rsquo;re using a device other than ESP32-S2, which does not have Bluetooth support. ","description":"Discover and analyze nearby Bluetooth Low Energy devices.","permalink":"/v1.9/ble/scanning/","title":"Scanning"},{"content":"GATT defines how BLE devices expose data. This guide shows how to discover services on a device.\nWhat is GATT?\rWhen a BLE device advertises, it broadcasts basic info. To learn what it actually does, you must connect and read its GATT profile. A GATT profile contains:\nServices — Logical groupings of related functionality (e.g., \u0026ldquo;Heart Rate Service\u0026rdquo;) Characteristics — Individual data points within a service (e.g., \u0026ldquo;Heart Rate Measurement\u0026rdquo;) UUIDs — Unique identifiers for each service and characteristic For example, a fitness tracker might expose:\nBattery Service (UUID 0x180F) with a Battery Level characteristic Heart Rate Service (UUID 0x180D) with Heart Rate Measurement characteristic Device Information Service (UUID 0x180A) with Manufacturer Name, Model Number, etc. Prerequisites\rGhostESP device with Bluetooth support (not ESP32-S2) Target BLE device powered on and in range Quick Start\rOn-Device UI\rMenu → Bluetooth → GATT Scan → Start GATT Scan to discover devices List GATT Devices to see what was found Select GATT Device to pick one by index Enumerate Services to connect and read its GATT profile Track Device to locate it by signal strength Command Line\rblescan -g # Start GATT scan\rlistgatt # List discovered devices\rselectgatt 0 # Select device at index 0\renumgatt # Connect and enumerate services\rtrackgatt # Track by signal strength\rblescan -s # Stop scanning Step-by-Step Walkthrough\rStep 1: Scan for Connectable Devices\rStart a GATT scan to find BLE devices that accept connections:\nUI: Menu → Bluetooth → GATT Scan → Start GATT Scan\nCLI: blescan -g\nThe scan runs continuously, discovering devices as they advertise. Leave it running for 10-30 seconds to find nearby devices.\nStep 2: List Discovered Devices\rView the devices found during the scan:\nUI: Menu → Bluetooth → GATT Scan → List GATT Devices\nCLI: listgatt\nExample output:\n[0] [AirTag] 5C:94:F2:xx:xx:xx (-67 dB)\r[1] [SmartTag] DC:71:96:xx:xx:xx (-72 dB) [2] [Tile] F1:23:xx:xx:xx:xx (-81 dB)\r[3] Unknown 4A:B2:xx:xx:xx:xx (-85 dB) The index number (e.g., [0]) is used to select a device. Tracker types are auto-detected and shown in brackets.\nStep 3: Select a Device\rChoose a device for enumeration:\nUI: Menu → Bluetooth → GATT Scan → Select GATT Device → Enter the index number\nCLI: selectgatt \u0026lt;index\u0026gt; (e.g., selectgatt 0)\nStep 4: Enumerate Services\rConnect to the selected device and read its GATT profile:\nUI: Menu → Bluetooth → GATT Scan → Enumerate Services\nCLI: enumgatt\nGhostESP will:\nEstablish a BLE connection Query all services Display each service with its UUID and handle range Identify known services by name Example output:\nConnecting to 5C:94:F2:xx:xx:xx...\rConnected!\rService: Generic Access (0x1800) [handles 1-7]\rService: Generic Attribute (0x1801) [handles 8-11]\rService: Battery Service (0x180F) [handles 12-15]\rService: Device Information (0x180A) [handles 16-28]\rService: Unknown (0xFD44) [handles 29-35] Step 5: Track by Signal Strength (Optional)\rUse RSSI tracking to physically locate a device:\nUI: Menu → Bluetooth → GATT Scan → Track Device\nCLI: trackgatt\nThe display shows:\nTracking: 5C:94:F2:xx:xx:xx\r█████░░░░░ -67 dB ↑ CLOSER\rMin: -89 dB | Max: -61 dB Signal bars — Visual strength indicator dB value — Current signal strength (closer to 0 = stronger) Direction — ↑ CLOSER or ↓ FARTHER based on recent trend Min/Max — Range seen during tracking Walk around while watching the signal strength to locate the device.\nAutomatic Tracker Detection\rDuring scanning, GhostESP identifies common tracker types by their manufacturer data:\nTracker Type Description AirTag Apple AirTags Apple FindMy Other Apple Find My devices SmartTag Samsung SmartTag trackers Tile Tile Bluetooth trackers Chipolo Chipolo trackers FindMy Clone Third-party Find My compatible devices Detected types appear in brackets when listing devices, e.g., [AirTag].\nService UUID Recognition\rGhostESP automatically identifies hundreds of known GATT services:\nStandard BLE Services (0x18xx)\rUUID Service Name 0x1800 Generic Access 0x1801 Generic Attribute 0x180A Device Information 0x180D Heart Rate 0x180F Battery Service 0x1812 Human Interface Device (HID) 0x1826 Fitness Machine Vendor Services\rGhostESP recognizes services from:\nApple — AirDrop, HomeKit, Siri, AirPlay, AirPods, Nearby Google — Fast Pair, Chromecast, Eddystone, Nearby Samsung — SmartThings, Gear Tile — Core, Ring, Identity, Firmware Nordic — UART Service (serial over BLE) Flipper Zero — Custom serial service Fitbit — Fitness tracker services Xiaomi — MiHome, Amazfit Others — Sonos, Meta/Oculus, Spotify, Tesla, Amazon Alexa Unknown services display their raw UUID for manual lookup.\nCLI Command Reference\rCommand Description blescan -g Start GATT device scan blescan -s Stop any active BLE scan listgatt List discovered GATT devices selectgatt \u0026lt;index\u0026gt; Select a device by index enumgatt Connect and enumerate services trackgatt Track selected device by RSSI Tips\rConnection timeouts: Some devices sleep aggressively. Try moving closer or interacting with the device to wake it. Privacy-focused devices: Some trackers rotate their MAC addresses. The device you see may have a different address on the next scan. Multiple scans: Run several short scans rather than one long scan to catch devices that advertise infrequently. Signal strength: RSSI values are approximate. Walls, interference, and antenna orientation all affect readings. Troubleshooting\r\u0026ldquo;No devices found\u0026rdquo; — Move closer to BLE devices, or wait longer for devices to advertise. \u0026ldquo;Connection failed\u0026rdquo; — The device may be paired to another host, sleeping, or out of range. Try again. \u0026ldquo;Service enumeration empty\u0026rdquo; — Some devices require bonding/pairing before exposing services. GhostESP does passive enumeration. Bluetooth not available — ESP32-S2 devices do not have Bluetooth hardware. ","description":"Connect to BLE devices and enumerate their services and characteristics.","permalink":"/v1.9/ble/gatt/","title":"GATT Discovery"},{"content":"Broadcast fake BLE advertisements to simulate nearby devices or spoof Apple AirTags and other Find My devices.\nWi-Fi impact: Starting a BLE spam or spoofing session pauses the GhostNet AP until you run stop (or the task ends). Wi-Fi resumes automatically when BLE deinitializes.\nPrerequisites\rGhostESP flashed device, powered on with a wireless antenna. Device must support Bluetooth (not available on ESP32-S2). Legal and ethical\rPatches and Mitigations\rMost modern devices (iOS 17+, Android 14+, Windows) block these attacks. They mostly affect older devices.\nSafety Warnings\rDo not use BLE attacks in public. They can crash devices and disrupt essential services.\nOnly use these features on devices you own or have permission to test.\nBLE Advertisement Spam\rBroadcast fake BLE advertisements to simulate nearby devices.\nOn-device UI\rOpen Menu → Bluetooth → Spam. You should see the spam options. Choose a spam type from the options below (for example, BLE Spam - Apple). The device will start broadcasting advertisements. Leave it running as long as you want. Select Stop BLE Spam to stop broadcasting. The device will show a summary of packets sent. Command line\rOpen the GhostESP terminal. Run blespam [TYPE] where the type is one of the modes below (for example, blespam -apple). The device will start broadcasting. Run stop when you\u0026rsquo;re done. The device will stop and show a summary. Spam modes\rApple Device Spam\rUI: Menu → Bluetooth → Spam → BLE Spam - Apple CLI: blespam -apple Broadcasts fake Apple device advertisements (AirPods, Apple TV, HomePod, AirTags, etc.). Uses Apple\u0026rsquo;s Continuity Protocol with randomized device types and colors. Nearby Apple devices may show pairing prompts or connection notifications. Microsoft Swift Pair Spam\rUI: Menu → Bluetooth → Spam → BLE Spam - Microsoft CLI: blespam -ms or blespam -microsoft Broadcasts fake Microsoft device advertisements with random device names. Targets Windows devices with Swift Pair notifications. Samsung Device Spam\rUI: Menu → Bluetooth → Spam → BLE Spam - Samsung CLI: blespam -samsung Broadcasts fake Samsung Galaxy Watch and other Samsung device advertisements. Targets Android devices with Samsung pairing prompts. Google Fast Pair Spam\rUI: Menu → Bluetooth → Spam → BLE Spam - Google CLI: blespam -google Broadcasts fake Google device advertisements using Google\u0026rsquo;s Fast Pair protocol. Targets Android devices with Google pairing notifications. Random Spam\rUI: Menu → Bluetooth → Spam → BLE Spam - Random CLI: blespam -random Cycles through all spam types (Apple, Microsoft, Samsung, Google) randomly. Broadcasts a mix of different device types to maximize disruption. AirTag Spoofing\rSpoof Apple AirTags and other Find My devices to broadcast their location. This makes your device appear as a legitimate AirTag to nearby Apple devices.\nWorkflow\rScan for AirTags\nOpen Menu → Bluetooth → AirTag → Start AirTag Scanner or run blescan -a. While the scanner is running, RSSI for already discovered AirTags is logged every few seconds in the terminal to show proximity changes. Wait for the scan to complete. List discovered AirTags\nOpen Menu → Bluetooth → AirTag → List AirTags or run list -airtags. You should see a list of discovered AirTags with their index numbers. Select an AirTag to spoof\nOpen Menu → Bluetooth → AirTag → Select AirTag. Enter the index number of the AirTag you want to spoof. Start spoofing\nOpen Menu → Bluetooth → AirTag → Spoof Selected AirTag or run spoofairtag. The device will broadcast as the selected AirTag. Nearby Apple devices will see your device as that AirTag. Stop spoofing\nOpen Menu → Bluetooth → AirTag → Stop Spoofing or run stopspoof. The device will stop broadcasting the AirTag advertisement. Notes\rBLE attacks are not available on ESP32-S2 devices. Spam attacks and spoofing are mutually exclusive; starting one will stop the other. The device broadcasts continuously until you explicitly stop it. Spam packet counts are logged every 5 seconds to the terminal. Apple spam uses different advertising intervals (~100ms) than other spam types for better compatibility. Spoofing captures the full AirTag advertisement payload during scanning for accurate reproduction. Troubleshooting\rAttacks not working: Check that your device has Bluetooth enabled and sufficient free memory. The AP pauses during attacks—if you need the web UI during testing, stop BLE first or use GhostLink. No AirTags found: Move closer to Apple devices with Find My enabled or try scanning again. Spoofing doesn\u0026rsquo;t appear on Apple devices: Ensure you\u0026rsquo;ve selected a valid AirTag before starting spoofing. Try stopping and restarting the spoof. Bluetooth not supported: Ensure you\u0026rsquo;re using a device other than ESP32-S2, which does not have Bluetooth support. ","description":"Send BLE advertisement spam and spoof AirTags.","permalink":"/v1.9/ble/attacks/","title":"Attacks"}]