(()=>{(()=>{let n=document.querySelector("[data-search-input]"),t=document.querySelector("[data-search-results]");if(!n||!t)return;let f=2,o=[],a=!1,l=!1,h=n.dataset.searchIndex||"index.json",p=e=>{if(t.innerHTML="",!e.length){t.dataset.visible="false";return}e.slice(0,8).forEach(s=>{let r=document.createElement("a");r.className="sidebar__result",r.href=s.permalink,r.setAttribute("role","option"),r.innerHTML=`<strong>${s.title}</strong><span>${s.description}</span>`,t.appendChild(r)}),t.dataset.visible="true"},c=e=>e.toLowerCase(),d=e=>{let s=c(e.trim());if(s.length<f){t.dataset.visible="false",t.innerHTML="";return}let r=o.filter(i=>{let g=`${i.title} ${i.description} ${i.content}`;return c(g).includes(s)});p(r)},u=async()=>{if(!(l||a)){a=!0;try{let e=await fetch(h,{credentials:"same-origin"});if(!e.ok)throw new Error("Failed to fetch search index");o=await e.json(),l=!0}catch(e){console.error(e)}finally{a=!1}}};n.addEventListener("input",e=>{u(),d(e.target.value)}),n.addEventListener("focus",()=>{u(),n.value.length&&d(n.value)}),document.addEventListener("click",e=>{e.target===n||t.contains(e.target)||(t.dataset.visible="false")})})();})();
