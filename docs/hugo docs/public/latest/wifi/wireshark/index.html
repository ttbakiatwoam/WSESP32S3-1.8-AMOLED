<!doctype html><html lang=en data-theme=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>USB Dongle Mode (Wireshark) · GhostESP Documentation</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Share+Tech+Mono&display=swap" rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css rel=stylesheet><link rel=stylesheet href=/css/main.min.333343cc98c92f6015786bf32d605cb6c14c60642eacf8de3b94d3248f97d117.css><link rel=canonical href=/latest/wifi/wireshark/><meta name=description content="Use GhostESP as a wireless capture dongle for Wireshark."><meta property="og:site_name" content="GhostESP Documentation"><meta property="og:type" content="article"><meta property="og:title" content="USB Dongle Mode (Wireshark)"><meta property="og:description" content="Use GhostESP as a wireless capture dongle for Wireshark."><meta property="og:url" content="/latest/wifi/wireshark/"><meta property="og:locale" content="en"><meta property="og:image" content="/images/ghostesp.1c3d9c47d752a1754fc78c41fddb238546a26cfcf2b07ddfe7a934b15cefba02.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="USB Dongle Mode (Wireshark)"><meta name=twitter:description content="Use GhostESP as a wireless capture dongle for Wireshark."><meta name=twitter:image content="/images/ghostesp.1c3d9c47d752a1754fc78c41fddb238546a26cfcf2b07ddfe7a934b15cefba02.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Q9CNW8QW7K"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Q9CNW8QW7K")</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","name":"GhostESP Documentation","description":"Use GhostESP as a wireless capture dongle for Wireshark.","url":"\/latest\/wifi\/wireshark\/","author":{"@type":"Organization","name":"GhostESP Team"},"publisher":{"@type":"Organization","name":"GhostESP"},"datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z"}</script><script>(function(){const e=localStorage.getItem("ghostesp-theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");document.documentElement.setAttribute("data-theme",e),window.innerWidth>=992&&localStorage.getItem("sidebarState")==="open"&&document.write('<style id="sidebar-pre-init">.sidebar { margin-left: 0; }</style>')})()</script></head><body><header class=topbar><button class=topbar__toggle type=button onclick=toggleSidebar() aria-label="Toggle navigation" aria-expanded=false>
<svg class="icon icon-menu" viewBox="0 0 24 24" aria-hidden="true"><line class="icon-menu__line icon-menu__line--top" x1="5" y1="7" x2="19" y2="7"/><line class="icon-menu__line icon-menu__line--middle" x1="5" y1="12" x2="19" y2="12"/><line class="icon-menu__line icon-menu__line--bottom" x1="5" y1="17" x2="19" y2="17"/></svg>
</button>
<a href=/ class=topbar__brand><img src=/images/ghostesp.1c3d9c47d752a1754fc78c41fddb238546a26cfcf2b07ddfe7a934b15cefba02.png alt="GhostESP: Revival" class=topbar__logo></a><div class=topbar__actions><button class=topbar__theme type=button data-theme-toggle aria-label="Toggle theme">
<svg class="icon icon-theme" viewBox="0 0 24 24" data-theme-icon="" aria-hidden="true"><g class="icon-theme__sun"><circle cx="12" cy="12" r="5"/><g class="icon-theme__sun-rays"><line x1="12" y1="2.5" x2="12" y2="5.5"/><line x1="12" y1="18.5" x2="12" y2="21.5"/><line x1="4.5" y1="12" x2="7.5" y2="12"/><line x1="16.5" y1="12" x2="19.5" y2="12"/><line x1="5.6" y1="5.6" x2="7.8" y2="7.8"/><line x1="16.2" y1="16.2" x2="18.4" y2="18.4"/><line x1="5.6" y1="18.4" x2="7.8" y2="16.2"/><line x1="16.2" y1="7.8" x2="18.4" y2="5.6"/></g></g><g class="icon-theme__moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></g></svg></button></div></header><div class=app><aside class=sidebar id=sidebar data-current-version=latest><div class=sidebar__brand><a href=/ class=sidebar__title><img src=/images/ghostesp.1c3d9c47d752a1754fc78c41fddb238546a26cfcf2b07ddfe7a934b15cefba02.png alt="GhostESP: Revival" class=sidebar__logo></a></div><div class=sidebar__version><label for=sidebar-version class=sidebar__version-label>Firmware version</label>
<select id=sidebar-version class=sidebar__version-select data-version-select><option value=latest selected>Latest</option><option value=v1.9>v1.9</option><option value=v1.8.1>v1.8.1</option><option value=v1.8>v1.8</option></select></div><div class=sidebar__search><input type=search placeholder=Search autocomplete=off data-search-input data-search-index=/index.json><div class=sidebar__search-results data-search-results role=listbox></div></div><nav class=sidebar__nav><a href=/latest/ class="sidebar__link sidebar__link--active">Home</a><div class=sidebar__group><button class="sidebar__group-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#collapse-latestgetting-started aria-expanded=false aria-controls=collapse-latestgetting-started>
<span>Getting Started</span>
<span class=sidebar__group-icon aria-hidden=true></span></button><div class="collapse sidebar__group-items" id=collapse-latestgetting-started><a href=/latest/getting-started/ class=sidebar__sublink>Overview</a>
<a href=/latest/getting-started/installation-guide/ class=sidebar__sublink>Installation Guide</a>
<a href=/latest/getting-started/supported-hardware/ class=sidebar__sublink>Supported Hardware</a>
<a href=/latest/getting-started/command-line-reference/ class=sidebar__sublink>CLI Reference</a>
<a href=/latest/getting-started/dual-communication/ class=sidebar__sublink>GhostLink</a>
<a href=/latest/getting-started/screen-mirroring/ class=sidebar__sublink>Screen Mirroring</a>
<a href=/latest/getting-started/webui-guide/ class=sidebar__sublink>WebUI</a>
<a href=/latest/getting-started/faq/ class=sidebar__sublink>FAQ</a>
<a href=/latest/getting-started/sd-card/ class=sidebar__sublink>SD Card</a></div></div><div class="sidebar__group group--open"><button class="sidebar__group-toggle sidebar__group-toggle--active" type=button data-bs-toggle=collapse data-bs-target=#collapse-latestwifi aria-expanded=true aria-controls=collapse-latestwifi>
<span>Wi-Fi</span>
<span class=sidebar__group-icon aria-hidden=true></span></button><div class="collapse show sidebar__group-items" id=collapse-latestwifi><a href=/latest/wifi/ class=sidebar__sublink>Overview</a>
<a href=/latest/wifi/basics/ class=sidebar__sublink>Wi-Fi Basics</a>
<a href=/latest/wifi/survey/ class=sidebar__sublink>Scanning networks</a>
<a href=/latest/wifi/capture/ class=sidebar__sublink>Capturing packets</a>
<a href=/latest/wifi/deauth/ class=sidebar__sublink>Deauthentication Attacks</a>
<a href=/latest/wifi/wireshark/ class="sidebar__sublink sidebar__sublink--active">USB Dongle Mode (Wireshark)</a>
<a href=/latest/wifi/handshakes/ class=sidebar__sublink>Capturing handshakes</a>
<a href=/latest/wifi/evil-portal/ class=sidebar__sublink>Evil Portal</a>
<a href=/latest/wifi/karma/ class=sidebar__sublink>Karma Attack</a>
<a href=/latest/wifi/aerial-detection/ class=sidebar__sublink>Aerial Detection</a>
<a href=/latest/wifi/dial-connect/ class=sidebar__sublink>DIAL Connect</a></div></div><div class=sidebar__group><button class="sidebar__group-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#collapse-latestble aria-expanded=false aria-controls=collapse-latestble>
<span>Bluetooth LE</span>
<span class=sidebar__group-icon aria-hidden=true></span></button><div class="collapse sidebar__group-items" id=collapse-latestble><a href=/latest/ble/ class=sidebar__sublink>Overview</a>
<a href=/latest/ble/scanning/ class=sidebar__sublink>Scanning</a>
<a href=/latest/ble/gatt/ class=sidebar__sublink>GATT Discovery</a>
<a href=/latest/ble/attacks/ class=sidebar__sublink>Attacks</a></div></div><div class=sidebar__group><button class="sidebar__group-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#collapse-latestinfrared aria-expanded=false aria-controls=collapse-latestinfrared>
<span>Infrared</span>
<span class=sidebar__group-icon aria-hidden=true></span></button><div class="collapse sidebar__group-items" id=collapse-latestinfrared><a href=/latest/infrared/ class=sidebar__sublink>Overview</a>
<a href=/latest/infrared/learning/ class=sidebar__sublink>Learning Signals</a>
<a href=/latest/infrared/transmitting/ class=sidebar__sublink>Transmitting Signals</a>
<a href=/latest/infrared/dazzler/ class=sidebar__sublink>IR Dazzler</a>
<a href=/latest/infrared/files/ class=sidebar__sublink>Infrared Files</a>
<a href=/latest/infrared/hardware/ class=sidebar__sublink>Hardware Support</a></div></div><div class=sidebar__group><button class="sidebar__group-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#collapse-latestnfc aria-expanded=false aria-controls=collapse-latestnfc>
<span>NFC</span>
<span class=sidebar__group-icon aria-hidden=true></span></button><div class="collapse sidebar__group-items" id=collapse-latestnfc><a href=/latest/nfc/ class=sidebar__sublink>Overview</a>
<a href=/latest/nfc/chameleon-ultra/ class=sidebar__sublink>Chameleon Ultra</a>
<a href=/latest/nfc/scanning/ class=sidebar__sublink>Scanning</a>
<a href=/latest/nfc/saving/ class=sidebar__sublink>Saving Tags</a>
<a href=/latest/nfc/writing/ class=sidebar__sublink>Writing NTAG</a>
<a href=/latest/nfc/supported/ class=sidebar__sublink>Supported Tags</a></div></div><div class=sidebar__group><button class="sidebar__group-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#collapse-latestusb aria-expanded=false aria-controls=collapse-latestusb>
<span>USB</span>
<span class=sidebar__group-icon aria-hidden=true></span></button><div class="collapse sidebar__group-items" id=collapse-latestusb><a href=/latest/usb/ class=sidebar__sublink>Overview</a>
<a href=/latest/usb/keyboard/ class=sidebar__sublink>Keyboard Control</a></div></div><div class=sidebar__group><button class="sidebar__group-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#collapse-latestethernet aria-expanded=false aria-controls=collapse-latestethernet>
<span>Ethernet</span>
<span class=sidebar__group-icon aria-hidden=true></span></button><div class="collapse sidebar__group-items" id=collapse-latestethernet><a href=/latest/ethernet/ class=sidebar__sublink>Overview</a>
<a href=/latest/ethernet/connection/ class=sidebar__sublink>Connection Management</a>
<a href=/latest/ethernet/fingerprinting/ class=sidebar__sublink>Network Fingerprinting</a>
<a href=/latest/ethernet/scanning/ class=sidebar__sublink>Network Scanning</a>
<a href=/latest/ethernet/http/ class=sidebar__sublink>HTTP Requests</a></div></div><div class=sidebar__group><button class="sidebar__group-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#collapse-latestdevelopment aria-expanded=false aria-controls=collapse-latestdevelopment>
<span>Development</span>
<span class=sidebar__group-icon aria-hidden=true></span></button><div class="collapse sidebar__group-items" id=collapse-latestdevelopment><a href=/latest/development/ class=sidebar__sublink>Overview</a>
<a href=/latest/development/build-py-kconfig/ class=sidebar__sublink>Adjusting build options</a></div></div></nav></aside><div class=content><main class=content__body><article class=doc><header><h1>USB Dongle Mode (Wireshark)</h1><p>Use GhostESP as a wireless capture dongle for Wireshark.</p></header><aside class=doc__toc><h2>On this page</h2><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#setup>Setup</a><ul><li><a href=#option-1-gui-installer-recommended>Option 1: GUI Installer (Recommended)</a></li><li><a href=#option-2-manual-installation>Option 2: Manual Installation</a></li><li><a href=#verify-installation>Verify installation</a></li></ul></li><li><a href=#capturing-wi-fi-traffic>Capturing Wi-Fi traffic</a><ul><li><a href=#start-capture-in-wireshark>Start capture in Wireshark</a></li><li><a href=#what-youll-see>What you&rsquo;ll see</a></li><li><a href=#channel-hopping-vs-channel-lock>Channel hopping vs. Channel lock</a></li><li><a href=#stop-capture>Stop capture</a></li></ul></li><li><a href=#capturing-ble-traffic>Capturing BLE traffic</a><ul><li><a href=#start-ble-capture>Start BLE capture</a></li><li><a href=#what-youll-see-1>What you&rsquo;ll see</a></li><li><a href=#stop-capture-1>Stop capture</a></li></ul></li><li><a href=#command-line-alternative>Command line alternative</a><ul><li><a href=#wi-fi-capture>Wi-Fi capture</a></li><li><a href=#ble-capture>BLE capture</a></li><li><a href=#stop-capture-2>Stop capture</a></li></ul></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#interface-not-showing-in-wireshark>Interface not showing in Wireshark</a></li><li><a href=#no-packets-appearing>No packets appearing</a></li><li><a href=#malformed-packets-in-wi-fi-capture>Malformed packets in Wi-Fi capture</a></li><li><a href=#slow-packet-rate>Slow packet rate</a></li><li><a href=#country-setting-not-applied>Country setting not applied</a></li></ul></li><li><a href=#notes>Notes</a></li><li><a href=#next-steps>Next steps</a></li></ul></nav></aside><p>Use your GhostESP as a <strong>USB wireless capture dongle</strong> for Wireshark. Instead of saving packets to an SD card, the device streams Wi-Fi and BLE traffic directly to your computer in real-time—just like a commercial Wi-Fi adapter in monitor mode.</p><p>This is perfect for live analysis, debugging networks, or learning how wireless protocols work without needing expensive hardware.</p><h2 id=prerequisites>Prerequisites
<a class=heading-anchor href=#prerequisites aria-label="Copy link to this section"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><g stroke="currentColor" stroke-width="1.2" stroke-linecap="round" fill="none" transform="rotate(45 12 12)"><path d="M14 12c0 2.761-2.239 5-5 5H7A5 5 0 117 7h.5"/><path d="M10 12c0-2.761 2.239-5 5-5h2a5 5 0 010 10h-.5"/></g></svg></a></h2><ul><li>GhostESP device connected via USB to your computer</li><li>Wireshark installed on your computer</li></ul><h2 id=setup>Setup
<a class=heading-anchor href=#setup aria-label="Copy link to this section"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><g stroke="currentColor" stroke-width="1.2" stroke-linecap="round" fill="none" transform="rotate(45 12 12)"><path d="M14 12c0 2.761-2.239 5-5 5H7A5 5 0 117 7h.5"/><path d="M10 12c0-2.761 2.239-5 5-5h2a5 5 0 010 10h-.5"/></g></svg></a></h2><h3 id=option-1-gui-installer-recommended>Option 1: GUI Installer (Recommended)</h3><p>The easiest way to install is using the GUI installer, which automatically handles dependencies and installation:</p><ol><li>Navigate to <code>scripts/wireshark_extcap_installer/</code> in your GhostESP repository</li><li>Run the installer:<pre tabindex=0><code>python installer_gui.py
</code></pre></li><li>Click <strong>Install</strong> in the GUI</li><li>Restart Wireshark</li></ol><p>The installer will automatically:</p><ul><li>Detect your Wireshark installation</li><li>Install the extcap files to the correct location</li><li>Set up all required dependencies in an isolated environment</li></ul><h3 id=option-2-manual-installation>Option 2: Manual Installation</h3><p>If you prefer manual installation:</p><p><strong>Prerequisites for manual installation:</strong></p><ul><li>Python 3.7+ installed</li><li><code>pyserial</code> Python package (<code>pip install pyserial</code>)</li></ul><p><strong>Installation steps:</strong></p><ol><li><p>Copy the extcap files to your Wireshark extcap folder:</p><ul><li><strong>Windows</strong>: <code>%APPDATA%\Wireshark\extcap\</code></li><li><strong>macOS</strong>: <code>~/.local/lib/wireshark/extcap/</code></li><li><strong>Linux</strong>: <code>~/.local/lib/wireshark/extcap/</code></li></ul></li><li><p>Files to copy from <code>scripts/wireshark_extcap_installer/</code>:</p><ul><li><code>ghostesp_extcap.py</code></li><li><code>ghostesp_extcap.bat</code> (Windows only)</li></ul></li><li><p>Make the script executable (macOS/Linux only):</p><pre tabindex=0><code>chmod +x ~/.local/lib/wireshark/extcap/ghostesp_extcap.py
</code></pre></li><li><p>Restart Wireshark.</p></li></ol><h3 id=verify-installation>Verify installation</h3><ol><li>Open Wireshark.</li><li>Go to <strong>Capture → Options</strong> or click the gear icon.</li><li>Look for <strong>GhostESP WiFi/BLE Capture</strong> in the interface list.<ul><li>If you don&rsquo;t see it, check that the files are in the correct extcap folder and Python is in your PATH.</li></ul></li></ol><h2 id=capturing-wi-fi-traffic>Capturing Wi-Fi traffic
<a class=heading-anchor href=#capturing-wi-fi-traffic aria-label="Copy link to this section"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><g stroke="currentColor" stroke-width="1.2" stroke-linecap="round" fill="none" transform="rotate(45 12 12)"><path d="M14 12c0 2.761-2.239 5-5 5H7A5 5 0 117 7h.5"/><path d="M10 12c0-2.761 2.239-5 5-5h2a5 5 0 010 10h-.5"/></g></svg></a></h2><h3 id=start-capture-in-wireshark>Start capture in Wireshark</h3><ol><li>In Wireshark, find <strong>GhostESP WiFi/BLE Capture</strong> in the interface list.</li><li>Click the <strong>gear icon</strong> next to it to configure:<ul><li><strong>Serial Port</strong>: Select your GhostESP COM port</li><li><strong>Baud Rate</strong>: Leave at 115200 (default)</li><li><strong>Capture Type</strong>: Select <strong>WiFi</strong></li><li><strong>Channel Lock</strong>: Choose between:<ul><li><strong>Auto (channel hopping)</strong>: Continuously hop through all channels (default)</li><li><strong>Channel 1-13</strong>: Lock to a specific WiFi channel for focused capture</li></ul></li></ul></li><li>Click <strong>Start</strong> to begin capturing.</li></ol><p>The GhostESP will automatically:</p><ul><li>Enter monitor mode</li><li>Start capture based on your Channel Lock setting:<ul><li><strong>Auto mode</strong>: Channel hop through all legal channels (150ms per channel)</li><li><strong>Fixed channel</strong>: Monitor only the selected channel continuously</li></ul></li><li>Stream packets in real-time to Wireshark</li></ul><h3 id=what-youll-see>What you&rsquo;ll see</h3><p>Wireshark will display:</p><ul><li><strong>Beacon frames</strong>: Access points advertising their SSIDs</li><li><strong>Probe requests</strong>: Devices searching for known networks</li><li><strong>Data frames</strong>: Encrypted Wi-Fi traffic</li><li><strong>Management frames</strong>: Association, authentication, deauth</li><li><strong>Control frames</strong>: ACKs, RTS/CTS</li></ul><h3 id=channel-hopping-vs-channel-lock>Channel hopping vs. Channel lock</h3><p><strong>Auto (Channel Hopping)</strong></p><ul><li>Continuously hops through all legal channels for your country</li><li><strong>2.4 GHz</strong>: Channels 1-13 (or 1-14 for Japan)</li><li><strong>5 GHz</strong> (ESP32-C5/C6 only): Country-specific channels<ul><li><strong>US/CA</strong>: All UNII bands (36-165)</li><li><strong>EU</strong>: UNII-1, 2a, 2c (36-140)</li><li><strong>JP</strong>: UNII-1, 2a, 2c (36-140, no 165)</li><li><strong>CN</strong>: UNII-1, 2a, 3 (36-64, 149-165)</li></ul></li><li>Best for general surveillance and discovering networks</li><li>Set your country with the <code>setcountry</code> command before starting capture</li></ul><p><strong>Fixed Channel Lock</strong></p><ul><li>Monitors only the selected channel continuously</li><li>Higher packet capture rate on the target channel</li><li>Ideal for:<ul><li>Analyzing traffic on a known network</li><li>Capturing handshakes from a specific AP</li><li>Debugging connectivity issues</li><li>Following a specific conversation</li></ul></li></ul><p>Set your country with the <code>setcountry</code> command before starting capture.</p><h3 id=stop-capture>Stop capture</h3><p>Click the red <strong>Stop</strong> button in Wireshark or run <code>capture -stop</code> on the GhostESP terminal.</p><h2 id=capturing-ble-traffic>Capturing BLE traffic
<a class=heading-anchor href=#capturing-ble-traffic aria-label="Copy link to this section"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><g stroke="currentColor" stroke-width="1.2" stroke-linecap="round" fill="none" transform="rotate(45 12 12)"><path d="M14 12c0 2.761-2.239 5-5 5H7A5 5 0 117 7h.5"/><path d="M10 12c0-2.761 2.239-5 5-5h2a5 5 0 010 10h-.5"/></g></svg></a></h2><h3 id=start-ble-capture>Start BLE capture</h3><ol><li>In Wireshark, configure <strong>GhostESP WiFi/BLE Capture</strong>:<ul><li><strong>Serial Port</strong>: Select your GhostESP COM port</li><li><strong>Capture Type</strong>: Select <strong>Bluetooth LE</strong></li></ul></li><li>Click <strong>Start</strong>.</li></ol><p>The GhostESP will stream BLE advertising packets to Wireshark.</p><h3 id=what-youll-see-1>What you&rsquo;ll see</h3><p>Wireshark will decode:</p><ul><li><strong>LE Advertising Reports</strong>: Device advertisements with names, UUIDs, manufacturer data</li><li><strong>RSSI values</strong>: Signal strength for each packet</li><li><strong>MAC addresses</strong>: Device identifiers (public or random)</li><li><strong>Advertisement data</strong>: Service UUIDs, local names, flags</li></ul><h3 id=stop-capture-1>Stop capture</h3><p>Click <strong>Stop</strong> in Wireshark or run <code>capture -stop</code> on the device.</p><h2 id=command-line-alternative>Command line alternative
<a class=heading-anchor href=#command-line-alternative aria-label="Copy link to this section"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><g stroke="currentColor" stroke-width="1.2" stroke-linecap="round" fill="none" transform="rotate(45 12 12)"><path d="M14 12c0 2.761-2.239 5-5 5H7A5 5 0 117 7h.5"/><path d="M10 12c0-2.761 2.239-5 5-5h2a5 5 0 010 10h-.5"/></g></svg></a></h2><p>You can also start Wireshark mode from the GhostESP terminal without using the Wireshark interface:</p><h3 id=wi-fi-capture>Wi-Fi capture</h3><pre tabindex=0><code>capture -wireshark [-c &lt;channel&gt;]
</code></pre><ul><li><code>-c &lt;channel></code>: Optional channel lock (1-13)</li><li>Without <code>-c</code>: Auto channel hopping</li><li>With <code>-c</code>: Lock to specific channel</li></ul><h3 id=ble-capture>BLE capture</h3><pre tabindex=0><code>capture -wiresharkble
</code></pre><h3 id=stop-capture-2>Stop capture</h3><pre tabindex=0><code>capture -stop
</code></pre><p>When using command line mode, you&rsquo;ll need to manually configure Wireshark to capture from the serial port.</p><h2 id=troubleshooting>Troubleshooting
<a class=heading-anchor href=#troubleshooting aria-label="Copy link to this section"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><g stroke="currentColor" stroke-width="1.2" stroke-linecap="round" fill="none" transform="rotate(45 12 12)"><path d="M14 12c0 2.761-2.239 5-5 5H7A5 5 0 117 7h.5"/><path d="M10 12c0-2.761 2.239-5 5-5h2a5 5 0 010 10h-.5"/></g></svg></a></h2><h3 id=interface-not-showing-in-wireshark>Interface not showing in Wireshark</h3><ul><li>Verify the extcap files are in the correct folder</li><li>Check that Python is installed and in your system PATH</li><li>Restart Wireshark after copying the files</li><li>Run <code>python ghostesp_extcap.py --extcap-interfaces</code> in the extcap folder to test</li></ul><h3 id=no-packets-appearing>No packets appearing</h3><ul><li>Confirm the correct COM port is selected</li><li>Check that the GhostESP is connected and powered on</li><li>Verify the device responds to serial commands</li><li>Try increasing the baud rate if packets are being dropped</li></ul><h3 id=malformed-packets-in-wi-fi-capture>Malformed packets in Wi-Fi capture</h3><ul><li>This is normal for promiscuous mode capture</li><li>The ESP32 captures everything including corrupted frames and radio noise</li><li>Valid packets will appear alongside malformed ones</li><li>Use Wireshark filters to focus on valid frames</li></ul><h3 id=slow-packet-rate>Slow packet rate</h3><ul><li>USB serial has limited throughput (~11 KB/s at 115200 baud)</li><li>High-traffic environments may drop packets</li><li>Channel hopping reduces time on each channel</li><li>This is expected behavior for live capture</li></ul><h3 id=country-setting-not-applied>Country setting not applied</h3><ul><li>Run <code>setcountry &lt;code></code> before starting capture (e.g., <code>setcountry US</code>)</li><li>Restart the device after changing country</li><li>Verify with <code>info</code> command that country is set correctly</li></ul><h2 id=notes>Notes
<a class=heading-anchor href=#notes aria-label="Copy link to this section"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><g stroke="currentColor" stroke-width="1.2" stroke-linecap="round" fill="none" transform="rotate(45 12 12)"><path d="M14 12c0 2.761-2.239 5-5 5H7A5 5 0 117 7h.5"/><path d="M10 12c0-2.761 2.239-5 5-5h2a5 5 0 010 10h-.5"/></g></svg></a></h2><ul><li>Wireshark mode streams packets over USB/UART without saving to SD card</li><li>The device automatically handles PCAP formatting and headers</li><li><strong>Auto mode</strong>: Channel hopping covers the full spectrum but reduces dwell time per channel</li><li><strong>Fixed channel</strong>: Higher packet capture rate on the selected channel</li><li>For focused capture on a single channel, use either Channel Lock setting or file-based capture modes</li><li>BLE capture does not hop channels (BLE uses 3 advertising channels: 37, 38, 39)</li><li>Channel lock is only available for WiFi capture, not BLE</li></ul><h2 id=next-steps>Next steps
<a class=heading-anchor href=#next-steps aria-label="Copy link to this section"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><g stroke="currentColor" stroke-width="1.2" stroke-linecap="round" fill="none" transform="rotate(45 12 12)"><path d="M14 12c0 2.761-2.239 5-5 5H7A5 5 0 117 7h.5"/><path d="M10 12c0-2.761 2.239-5 5-5h2a5 5 0 010 10h-.5"/></g></svg></a></h2><ul><li><a href=/latest/wifi/capture/>Capturing packets to file</a> — Save captures to SD card for later analysis</li><li><a href=/latest/wifi/handshakes/>Handshakes</a> — Extract WPA/WPA2 authentication data</li><li><a href=/latest/wifi/survey/>Survey</a> — Scan for networks and devices</li></ul><nav class=doc__nav aria-label="Document navigation"><a class="doc__nav-link doc__nav-link--prev" href=/latest/wifi/deauth/><span>← Previous</span>
<span>Deauthentication Attacks</span>
</a><a class="doc__nav-link doc__nav-link--next" href=/latest/wifi/handshakes/><span>Next →</span>
<span>Capturing handshakes</span></a></nav></article></main><footer class=content__footer><p>website made with love by jay candel &lt;3</p></footer></div></div><div class=sidebar__overlay id=overlay onclick=toggleSidebar()></div><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js></script><script src=https://cdn.jsdelivr.net/npm/fuse.js@7.0.0/dist/fuse.min.js></script><script src=/js/search.ef50286594fda7181140155c44b192feda3337818f68d846b1c63109da0b2251.js defer></script><script src=/js/sidebar.9132b3f444f2ebe86edbf6429f4c0f533f27e02b1ac29f2b450abe1616f06852.js defer></script><script src=/js/theme.0d48f97778d5930c369632719af2ad7eb9f6a039eedd5cc721e5dbda6e9d8925.js defer></script></body></html>