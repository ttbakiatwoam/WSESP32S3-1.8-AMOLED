[{"content":"Wi-Fi attacks sound complex, but they\u0026rsquo;re built on a few simple ideas. This page explains what each attack does, why someone might use it, and what you need to know before trying the tools in GhostESP.\nWhat is a Wi-Fi attack?\rA Wi-Fi attack is any action that disrupts, intercepts, or tricks Wi-Fi networks or devices. Most attacks fall into two categories:\nPassive: You listen and record without sending anything. Example: capturing packets to see what devices are on a network. Active: You send frames or signals to change how the network behaves. Example: sending deauth frames to kick devices off. Common attacks explained\rPacket Capture\rWhat it does: Records all Wi-Fi traffic on a channel and saves it to a file (PCAP format).\nWhy: You can analyze the data later to see what devices are connecting, what SSIDs they\u0026rsquo;re looking for, or extract handshakes for password testing.\nLegal note: Capturing traffic on networks you don\u0026rsquo;t own is illegal in most places. Only do this on your own network or with explicit permission.\nLearn more: Capturing packets\nDeauthentication (Deauth)\rWhat it does: Sends a fake \u0026ldquo;disconnect\u0026rdquo; message to a device, forcing it off the network.\nWhy: Tests network stability, forces devices to reconnect (so you can capture their handshake), or disrupts a specific device.\nLegal note: Deauthing devices you don\u0026rsquo;t own is illegal. Only test on your own network.\nLearn more: Deauthentication attacks\nKarma Attack\rWhat it does: Pretends to be a Wi-Fi network that a device is looking for, tricking the device into connecting.\nWhy: Intercept traffic from devices or test how they behave when connecting to fake networks.\nLegal note: Tricking devices into connecting without consent is illegal in most jurisdictions.\nLearn more: Karma attacks\nEvil Portal\rWhat it does: Creates a fake Wi-Fi network with a login page that looks real (like a coffee shop Wi-Fi).\nWhy: Capture credentials, redirect users to a phishing site, or test how users respond to fake login pages.\nLegal note: Impersonating a real network or capturing credentials without consent is illegal.\nLearn more: Evil portals\nHandshake Capture\rWhat it does: Records the WPA/WPA2 authentication handshake between a device and router.\nWhy: Export the handshake to offline password cracking tools to test weak passwords.\nLegal note: Cracking passwords on networks you don\u0026rsquo;t own is illegal.\nLearn more: Handshakes\nBefore you start\rPrerequisites\rA GhostESP device (flashed and working) An SD card (for saving captures) A network you own or have permission to test Basic understanding of Wi-Fi (SSIDs, channels, 2.4 GHz vs 5 GHz) Legal and ethical rules\rOnly test networks you own or have written permission to test. Unauthorized access to networks or devices is illegal in most countries. Disrupting networks (deauth, jamming) without permission is illegal. Impersonating networks or capturing credentials is illegal. Check your local laws before testing. Typical workflow\rScan the area to find networks and devices (see Survey). Choose an attack based on what you want to learn (see attack descriptions above). Capture or execute using the GhostESP menu or CLI. Analyze the results on your computer (e.g., open PCAP files in Wireshark). Next steps\rPick an attack that interests you and read the detailed guide:\nCapturing packets — Record Wi-Fi traffic Handshakes — Extract authentication data Karma attacks — Trick devices into connecting Evil portals — Create fake login pages Survey — Scan for networks and devices ","description":"Learn what Wi-Fi attacks are and how they work before diving into tools.","permalink":"/latest/wifi/basics/","title":"Wi-Fi Basics"},{"content":"Discover nearby Wi-Fi networks and gather information about them. You can scan passively without connecting, or connect to a network and explore devices on it.\nPrerequisites\rGhostESP flashed device, powered on with a wireless antenna. Finding nearby networks\rOn-device UI\rOpen Menu → WiFi → Scanning. You should see a menu with scan options. Choose Scan Access Points. The device will search for networks. Wait for the scan to finish and see a summary. Select List Access Points. You should see each network listed with its name, channel, signal strength, and device manufacturer. On-device UI — Optional features\rScan APs Live: Watch new networks appear in real time as they\u0026rsquo;re discovered. Channel Congestion: See how busy the wireless channels are in your area. Command line\rOpen the GhostESP terminal (serial connection or on-device terminal). Run scanap to start a scan. Wait for it to finish and show results. Run list -a to see the cached list of networks. Command line — Optional features\rRun scanap -live to watch networks appear as they\u0026rsquo;re discovered. Exploring a network\rOnce you connect to a network, you can discover devices and services on it.\nConnect to a network\rOpen Menu → WiFi → Connection → Connect to WiFi. Enter the network name and password when prompted. Wait for the connection to complete. The terminal will show status updates. To disconnect later, go to Menu → WiFi → Connection → Disconnect. Connect via command line\rRun connect \u0026quot;SSID\u0026quot; \u0026quot;password\u0026quot; (use quotes if the name or password has spaces). The terminal will show connection progress and confirm when connected. Run connect with no arguments to reconnect to the last network you used. Run disconnect to leave the network. Find devices on the network\rOpen Menu → WiFi → Scanning while connected. Choose Scan LAN Devices. You should see a list of devices and services on the network. Find devices via command line\rRun scanlocal to discover devices and services. You should see hostnames, service types, and ports. Run scanarp to find all active devices on the network. You should see IP addresses and device information. Check for open ports\rFrom the UI, select a device with Select LAN, then choose Scan Open Ports. You should see which ports are responding on that device. From the command line, run scanports \u0026lt;ip\u0026gt; to check a specific device. You should see open ports listed. Add all to check all ports, or start-end (like 20-1024) for a range. Run scanssh \u0026lt;ip\u0026gt; to specifically check if a device has SSH enabled. Full environment sweep\rScan all wireless activity at once and save results to your SD card.\nWhat it captures\rWiFi Access Points: Name, MAC, channel, frequency, signal strength, security type, cipher, 802.11 mode, WPS status WiFi Clients: MAC address and associated AP BLE Devices: Flippers, GATT devices, and raw BLE packets 802.15.4 Packets: Zigbee/Thread traffic (ESP32-C5 and C6 only) GPS Coordinates: Location data for each entry (if GPS module connected) Run a sweep from the UI\rOpen Menu → WiFi → Scanning → Sweep. The device will run through each scan phase automatically. Wait for all phases to complete. Progress is shown on screen. Find results in /ghostesp/sweeps/sweep_N.csv on your SD card. Run a sweep from command line\rRun sweep to start with default timing (10 seconds per phase). Customize timing with flags: sweep -w 15 for 15-second WiFi scans sweep -b 20 for 20-second BLE scans sweep -w 15 -b 20 to set both Run sweep -h to see all options. CSV output format\rResults are saved in a format similar to Kismet/Wigle exports:\nType,Name,MAC,Associated MAC,Channel,Frequency,RSSI,Auth,Cipher,802.11,WPS,Latitude,Longitude,Altitude,First Seen\rWiFi AP,MyNetwork,AA:BB:CC:DD:EE:FF,,6,2437,-45,WPA2,CCMP,ax/n/g/b,No,37.774929,-122.419416,10.5,2025-12-09 17:30:00\rWiFi Client,,11:22:33:44:55:66,AA:BB:CC:DD:EE:FF,,,,,,,37.774929,-122.419416,10.5,2025-12-09 17:30:00 Troubleshooting\rNo networks found: Move closer to wireless routers and try scanning again. \u0026ldquo;You Need to Scan APs First\u0026rdquo; message: Run a scan before trying to select a network. Live scan stops right away: Stop any active Wi-Fi attacks or portals from the menu and try again. FAQ\rCan I scan while connected to a network? Yes. The device will pause the connection briefly to scan, then resume. Where do the device vendor names come from? GhostESP looks up the device\u0026rsquo;s hardware address in a built-in database to identify the manufacturer. ","description":"Find and review Wi-Fi networks in your area.","permalink":"/latest/wifi/survey/","title":"Scanning networks"},{"content":"Record Wi-Fi network traffic and save it to the SD card. You can then review the captured data on your computer or Flipper Zero.\nPrerequisites\rGhostESP flashed device with an SD card mounted. Optional: Flipper Zero with a microSD card if you want to save captures to the flipper. Capturing traffic\rOn-device UI\rOpen Menu → WiFi → Capture. You should see a list of capture types to choose from. Select the type of traffic you want to record (see capture types below). The device will start recording. Leave it running until you have enough data. Back out of the terminal view to stop recording. The device will save the file to the SD card and show the file path. Retrieve the file from the SD card using the GhostNet WebUI file browser or by removing the card. Files are saved under /mnt/ghostesp/pcaps/ with names like probescan_3.pcap. Command line\rOpen the GhostESP terminal. Run capture -\u0026lt;type\u0026gt; where type is one of the capture types below (for example, capture -probe). The device will start recording. Let it run while traffic is collected. Run capture -stop when you\u0026rsquo;re done. The device will save the file and show where it was saved. Capture modes\r-probe: Records probe requests so you can see devices searching for known SSIDs. -deauth: Records deauthentication frames to diagnose disconnect storms or targeted kicks. -beacon: Records beacons to review advertised SSIDs and channel metadata. -raw: Dumps every Wi-Fi frame seen on the tuned channel for full analysis. -eapol: Captures WPA/WPA2 4-way handshakes, PMKID messages, and rekeys so you can validate client authentications or export the flow for offline key cracking. -pwn: Records frames from Pwnagotchi devices. -wps: Captures Wi-Fi Protected Setup traffic to confirm whether a router exposes WPS enrolment. -802154 (ESP32-C5/C6 only): Records IEEE 802.15.4 frames when you supply capture -802154. Verify\rConfirm the SD card contains a .pcap file. Open the file in Wireshark app to make sure packets are listed. Notes\rCaptures save to /mnt/ghostesp/pcaps/ only when an SD card is mounted. If the folder is missing the device streams packets over UART to the Flipper Zero when writing a file. The firmware logs PCAP: saving to SD as ... when file storage is active, or PCAP: streaming over UART when it falls back to the terminal. Flipper Zero GhostESP app expects captures under /ext/apps_data/ghost_esp/pcaps/ on its microSD. Copy the .pcap using QFlipper or directly from the Flipper\u0026rsquo;s SD card to review in Wireshark. Large captures can take time to copy. Use a card reader instead of QFlipper or the WebUI for faster transfers. Troubleshooting\rCapture file not saved: Make sure the SD card is mounted and has free space. Always use stop or back out through the menu to properly save the file. SD card not recognized: Reboot the device with the SD card already inserted. Check that the card is properly seated and not corrupted. File transfer is slow: Use a card reader connected to your computer instead of the WebUI or other methods for faster transfers. ","description":"Record Wi-Fi traffic to a PCAP for later analysis.","permalink":"/latest/wifi/capture/","title":"Capturing packets"},{"content":"Deauthentication (deauth) attacks force devices to disconnect from a Wi-Fi network. This is useful for testing network resilience or capturing authentication handshakes when devices reconnect.\nNote: Only perform deauth attacks on networks you own or have explicit permission to test. Disrupting networks without authorization is illegal.\nHow it works\rWi-Fi networks use management frames to coordinate connections. Two of these frames can terminate a connection:\nDeauthentication frame: Ends the authentication relationship Disassociation frame: Ends the association relationship GhostESP sends both frame types. Since these frames are part of the original Wi-Fi standard (802.11), most devices have no way to verify if the message is legitimate.\nBroadcast and targeted attacks\rThe attack sends frames in two ways:\nBroadcast (FF:FF:FF:FF:FF:FF): Hits all devices on the network without needing to know who\u0026rsquo;s connected Targeted: If you\u0026rsquo;ve scanned for stations (scansta), GhostESP automatically includes any discovered clients associated with the selected AP Bidirectional frames\rFor targeted stations, GhostESP sends frames in both directions:\nAP → Station: Appears to come from the access point, telling the device to disconnect Station → AP: Appears to come from the device, telling the AP the device is leaving This makes the attack more reliable since both sides think the connection ended.\nFrequency band limitations\r2.4 GHz only (most boards)\rMost ESP32 boards (ESP32, ESP32-S2, ESP32-S3, ESP32-C3, ESP32-C6) only support 2.4 GHz Wi-Fi. This means:\nYou can only deauth networks on channels 1–14 5 GHz networks are invisible and unaffected Many modern routers use both bands—devices on the 5 GHz band will stay connected 5 GHz support (ESP32-C5)\rThe ESP32-C5 supports both 2.4 GHz and 5 GHz bands, allowing you to:\nScan and attack networks on all Wi-Fi channels Target devices on 5 GHz networks If your target network uses 5 GHz, you need an ESP32-C5 based device.\nProtected Management Frames (PMF)\rPMF (also called MFP or 802.11w) is a security feature that cryptographically signs management frames. When enabled, devices can verify that deauth frames actually came from the real access point.\nNetworks immune to deauth\rWPA3 networks: PMF is mandatory. Deauth attacks will not work. WPA2/WPA3 mixed mode: Devices using WPA3 are protected; WPA2 devices may still be vulnerable. WPA2 with PMF enabled: Some enterprise networks enable PMF on WPA2. How to check\rWhen you scan networks on an ESP32-C5 or ESP32-C6, GhostESP shows the security type and PMF status:\nSSID: MyNetwork\rBand: 2.4GHz\rSecurity: WPA3\rPMF: Required If you see PMF: Required, deauth attacks will have no effect on that network.\nPrerequisites\rGhostESP device Target network on a supported frequency band (2.4 GHz for most boards, or 5 GHz with ESP32-C5) Country code set in device settings (see Troubleshooting if you get errors) Launching a deauth attack\rOn-device UI\rOpen Menu → WiFi → Scanning and wait for the scan to complete. Select your target with Select AP. Open Menu → WiFi → Attacks → Deauth. The device will continuously send deauth frames to all clients on that network. To stop, navigate to Menu → WiFi → Attacks → Stop Attack or run stopdeauth. Command line\rScan for networks: scanap List results: list -a Select your target (replace 1 with the network number): select -a 1 Start the attack: attack -d Stop the attack: stopdeauth Targeting multiple networks\rYou can select multiple access points at once:\nselect -a 1,3,5\rattack -d GhostESP groups APs by channel to minimize channel-switching overhead. APs on the same channel are attacked together before moving to the next channel.\nTroubleshooting\rESP_ERR_INVALID_ARG when deauthing\rThis error occurs when attempting to deauth a network on a channel not allowed by your current country code setting. By default, GhostESP uses \u0026ldquo;World Safe\u0026rdquo; mode (01) which only permits channels 1–11.\nIf your target network is on channel 12, 13, or 14, you must set the correct country code first.\nFix via on-device UI:\nOpen Menu → Settings → WiFi Country. Select your region. Restart the device. Fix via CLI (ESP32-C5 only):\nsetcountry \u0026lt;CC\u0026gt; Replace \u0026lt;CC\u0026gt; with one of the supported country codes:\nCode Region Code Region Code Region 01 World Safe AT Austria AU Australia BE Belgium BG Bulgaria BR Brazil CA Canada CH Switzerland CN China CY Cyprus CZ Czechia DE Germany DK Denmark EE Estonia ES Spain FI Finland FR France GB United Kingdom GR Greece HK Hong Kong HR Croatia HU Hungary IE Ireland IN India IS Iceland IT Italy JP Japan KR South Korea LI Liechtenstein LT Lithuania LU Luxembourg LV Latvia MT Malta MX Mexico NL Netherlands NO Norway NZ New Zealand PL Poland PT Portugal RO Romania SE Sweden SI Slovenia SK Slovakia TW Taiwan US United States Channel availability by region:\nUS, Canada (US, CA): Channels 1–11 Europe, Australia (GB, DE, AU, etc.): Channels 1–13 Japan (JP): Channels 1–14 Attack has no effect\rCheck the band: If the network is on 5 GHz and you\u0026rsquo;re using a 2.4 GHz-only board, the attack won\u0026rsquo;t work. Check for PMF: WPA3 networks and some WPA2 networks with PMF enabled are immune. Multiple APs: Some networks have multiple access points. You may need to target each one separately. Distance: Get closer to the access point for a stronger signal. Devices reconnect immediately\rDevices reconnect immediately after being kicked. If they keep getting back on:\nMake sure you\u0026rsquo;re only targeting one or two networks Move closer to the access point Check for other interference Cannot see 5 GHz networks\rYour board only supports 2.4 GHz. Use an ESP32-C5 based device to access 5 GHz networks.\nRelated attacks\rEAPOL Logoff (attack -e): Sends logoff frames instead of deauth frames. Works similarly but uses a different frame type. SAE Flood (attack -s): Floods WPA3 networks with authentication requests. Only available on ESP32-C5/C6. ","description":"Force devices to disconnect from a Wi-Fi network.","permalink":"/latest/wifi/deauth/","title":"Deauthentication Attacks"},{"content":"Use your GhostESP as a USB wireless capture dongle for Wireshark. Instead of saving packets to an SD card, the device streams Wi-Fi and BLE traffic directly to your computer in real-time—just like a commercial Wi-Fi adapter in monitor mode.\nThis is perfect for live analysis, debugging networks, or learning how wireless protocols work without needing expensive hardware.\nPrerequisites\rGhostESP device connected via USB to your computer Wireshark installed on your computer Setup\rOption 1: GUI Installer (Recommended)\rThe easiest way to install is using the GUI installer, which automatically handles dependencies and installation:\nNavigate to scripts/wireshark_extcap_installer/ in your GhostESP repository Run the installer: python installer_gui.py Click Install in the GUI Restart Wireshark The installer will automatically:\nDetect your Wireshark installation Install the extcap files to the correct location Set up all required dependencies in an isolated environment Option 2: Manual Installation\rIf you prefer manual installation:\nPrerequisites for manual installation:\nPython 3.7+ installed pyserial Python package (pip install pyserial) Installation steps:\nCopy the extcap files to your Wireshark extcap folder:\nWindows: %APPDATA%\\Wireshark\\extcap\\ macOS: ~/.local/lib/wireshark/extcap/ Linux: ~/.local/lib/wireshark/extcap/ Files to copy from scripts/wireshark_extcap_installer/:\nghostesp_extcap.py ghostesp_extcap.bat (Windows only) Make the script executable (macOS/Linux only):\nchmod +x ~/.local/lib/wireshark/extcap/ghostesp_extcap.py Restart Wireshark.\nVerify installation\rOpen Wireshark. Go to Capture → Options or click the gear icon. Look for GhostESP WiFi/BLE Capture in the interface list. If you don\u0026rsquo;t see it, check that the files are in the correct extcap folder and Python is in your PATH. Capturing Wi-Fi traffic\rStart capture in Wireshark\rIn Wireshark, find GhostESP WiFi/BLE Capture in the interface list. Click the gear icon next to it to configure: Serial Port: Select your GhostESP COM port Baud Rate: Leave at 115200 (default) Capture Type: Select WiFi Channel Lock: Choose between: Auto (channel hopping): Continuously hop through all channels (default) Channel 1-13: Lock to a specific WiFi channel for focused capture Click Start to begin capturing. The GhostESP will automatically:\nEnter monitor mode Start capture based on your Channel Lock setting: Auto mode: Channel hop through all legal channels (150ms per channel) Fixed channel: Monitor only the selected channel continuously Stream packets in real-time to Wireshark What you\u0026rsquo;ll see\rWireshark will display:\nBeacon frames: Access points advertising their SSIDs Probe requests: Devices searching for known networks Data frames: Encrypted Wi-Fi traffic Management frames: Association, authentication, deauth Control frames: ACKs, RTS/CTS Channel hopping vs. Channel lock\rAuto (Channel Hopping)\nContinuously hops through all legal channels for your country 2.4 GHz: Channels 1-13 (or 1-14 for Japan) 5 GHz (ESP32-C5/C6 only): Country-specific channels US/CA: All UNII bands (36-165) EU: UNII-1, 2a, 2c (36-140) JP: UNII-1, 2a, 2c (36-140, no 165) CN: UNII-1, 2a, 3 (36-64, 149-165) Best for general surveillance and discovering networks Set your country with the setcountry command before starting capture Fixed Channel Lock\nMonitors only the selected channel continuously Higher packet capture rate on the target channel Ideal for: Analyzing traffic on a known network Capturing handshakes from a specific AP Debugging connectivity issues Following a specific conversation Set your country with the setcountry command before starting capture.\nStop capture\rClick the red Stop button in Wireshark or run capture -stop on the GhostESP terminal.\nCapturing BLE traffic\rStart BLE capture\rIn Wireshark, configure GhostESP WiFi/BLE Capture: Serial Port: Select your GhostESP COM port Capture Type: Select Bluetooth LE Click Start. The GhostESP will stream BLE advertising packets to Wireshark.\nWhat you\u0026rsquo;ll see\rWireshark will decode:\nLE Advertising Reports: Device advertisements with names, UUIDs, manufacturer data RSSI values: Signal strength for each packet MAC addresses: Device identifiers (public or random) Advertisement data: Service UUIDs, local names, flags Stop capture\rClick Stop in Wireshark or run capture -stop on the device.\nCommand line alternative\rYou can also start Wireshark mode from the GhostESP terminal without using the Wireshark interface:\nWi-Fi capture\rcapture -wireshark [-c \u0026lt;channel\u0026gt;] -c \u0026lt;channel\u0026gt;: Optional channel lock (1-13) Without -c: Auto channel hopping With -c: Lock to specific channel BLE capture\rcapture -wiresharkble Stop capture\rcapture -stop When using command line mode, you\u0026rsquo;ll need to manually configure Wireshark to capture from the serial port.\nTroubleshooting\rInterface not showing in Wireshark\rVerify the extcap files are in the correct folder Check that Python is installed and in your system PATH Restart Wireshark after copying the files Run python ghostesp_extcap.py --extcap-interfaces in the extcap folder to test No packets appearing\rConfirm the correct COM port is selected Check that the GhostESP is connected and powered on Verify the device responds to serial commands Try increasing the baud rate if packets are being dropped Malformed packets in Wi-Fi capture\rThis is normal for promiscuous mode capture The ESP32 captures everything including corrupted frames and radio noise Valid packets will appear alongside malformed ones Use Wireshark filters to focus on valid frames Slow packet rate\rUSB serial has limited throughput (~11 KB/s at 115200 baud) High-traffic environments may drop packets Channel hopping reduces time on each channel This is expected behavior for live capture Country setting not applied\rRun setcountry \u0026lt;code\u0026gt; before starting capture (e.g., setcountry US) Restart the device after changing country Verify with info command that country is set correctly Notes\rWireshark mode streams packets over USB/UART without saving to SD card The device automatically handles PCAP formatting and headers Auto mode: Channel hopping covers the full spectrum but reduces dwell time per channel Fixed channel: Higher packet capture rate on the selected channel For focused capture on a single channel, use either Channel Lock setting or file-based capture modes BLE capture does not hop channels (BLE uses 3 advertising channels: 37, 38, 39) Channel lock is only available for WiFi capture, not BLE Next steps\rCapturing packets to file — Save captures to SD card for later analysis Handshakes — Extract WPA/WPA2 authentication data Survey — Scan for networks and devices ","description":"Use GhostESP as a wireless capture dongle for Wireshark.","permalink":"/latest/wifi/wireshark/","title":"USB Dongle Mode (Wireshark)"},{"content":"Capture Wi-Fi authentication handshakes from nearby networks.\nLegal note: Only capture traffic from networks you own or have explicit permission to test. Unauthorized network testing is illegal in most jurisdictions.\nPrerequisites\rGhostESP with SD card mounted (for saving captures). A device to connect to the target network (so it can authenticate and create a handshake). Capturing a handshake\rOn-device UI\rOpen Menu → WiFi → Scanning and find your target network. Select it with Select AP to lock onto that channel. Open Menu → WiFi → Capture → Capture Eapol. The device will start listening for authentication activity. Wait for a device to connect or reconnect to the network. You should see Handshake found! when the capture succeeds. Back out to stop capturing. The capture is saved to the SD card under /mnt/ghostesp/pcaps/. Command line\rRun list -a to see nearby networks. Run select -a \u0026lt;number\u0026gt; to lock onto your target network. Run capture -eapol to start listening. Wait for a device to authenticate to the network. You should see Handshake found! when successful. Run stop to finish capturing. The file location will be shown in the log. Next steps\rCopy the .pcap file from the device to your computer for further analysis. For Flipper Zero saved files, copy the file from /ext/apps_data/ghost_esp/pcaps/ on the Flipper\u0026rsquo;s SD card. Troubleshooting\rNo handshake found: Make sure a device is actually connecting to the network. Try toggling Wi-Fi off and on on a connected device to trigger a new authentication. Capture file missing: Verify the SD card is mounted and has free space. Check that you stopped the capture. ","description":"Record Wi-Fi authentication data for analysis.","permalink":"/latest/wifi/handshakes/","title":"Capturing handshakes"},{"content":"Create a fake Wi-Fi network that shows a login page when users connect.\nNote: Only test this on networks you own or have explicit permission to test. Unauthorized access to networks is illegal in most jurisdictions.\nPrerequisites\rSD card inserted and mounted. Portal files saved to the SD card (optional; there\u0026rsquo;s a default portal built in). Custom portal files go in /mnt/ghostesp/evil_portal/portals/ on the SD card. Place your HTML (and any referenced assets) there so listportals can find them. Starting a portal\rOn-device UI\rOpen WiFi → Evil Portal → Start Evil Portal. The device will launch the built-in default portal. To use a custom HTML page, choose Start Custom Evil Portal instead. Select your page and enter the network name and optional password. The portal is now running. Clients connecting to the network will see a login page. To stop, go back to the menu or run stopportal in the terminal. From the Flipper app\rOn the Flipper app, open WiFi → Evil Portal \u0026amp; Network → Set Evil Portal HTML. Pick your HTML file (up to 2048 bytes) from the file browser; it is sent and stored for the next start. Back in Evil Portal, choose Evil Portal to run the command. The UI appends startportal and prompts for arguments. Command format: startportal file/default SSID PSK. SSID/PSK should be entered without spaces (use dashes/underscores instead) or the command parser will split them incorrectly. If you already pushed HTML from the Flipper app, enter default for \u0026lt;file\u0026gt; to use the stored page automatically. Clients connecting to the network will see your uploaded portal. Command line\rRun listportals to see available portal pages. Run startportal default MyNetworkName to start with the built-in portal. Or use startportal mypage.html MyNetworkName for a custom page. (Optional) Add a password: startportal mypage.html MyNetworkName MyPassword. Avoid spaces in SSID/PSK here as well; use dashes/underscores so the CLI doesn\u0026rsquo;t misparse arguments. Run stopportal or stop to shut it down. What gets recorded\rSubmitted credentials are saved to /mnt/ghostesp/evil_portal/portal_creds_\u0026lt;n\u0026gt;.txt on the SD card. Keystrokes are logged to /mnt/ghostesp/evil_portal/portal_keystrokes_\u0026lt;n\u0026gt;.txt. Testing the portal\rConnect to the network from another device. Open a web browser and navigate to any website. You should see the login page instead. Submit test credentials. Check the SD card files to confirm they were recorded. Tips\rKeep custom portal pages simple and small for faster loading. Use a card reader to transfer files to/from the SD card quickly. Troubleshooting\rNo portal pages found: Make sure the SD card is mounted and has a /mnt/ghostesp/evil_portal/portals/ folder. Credentials not being saved: Verify the SD card has free space and is properly mounted. Clients don\u0026rsquo;t see the login page: Try opening a new browser tab or clearing the browser cache on the client device. Also make sure any \u0026lsquo;Private DNS\u0026rsquo; or similar setting on the client is turned off. ","description":"Host a fake Wi-Fi login page to test security awareness.","permalink":"/latest/wifi/evil-portal/","title":"Evil Portal"},{"content":"Create fake Wi-Fi networks based on SSIDs that nearby devices are searching for. When devices search for a network, Karma broadcasts it back to them.\nNote: Only test this on networks you own or have explicit permission to test. Unauthorized access to networks is illegal in most jurisdictions.\nPrerequisites\rGhostESP flashed device, powered on with a wireless antenna. Optional: SD card for evil portal integration. Legal and ethical\rOnly test on your own devices or with written permission. Never use Karma on networks you don\u0026rsquo;t own. Starting Karma\rOn-device UI\rOpen Menu → WiFi → Attacks → Start Karma Attack. The device will begin learning SSIDs from probe requests. To use specific SSIDs instead, choose Start Karma Attack (Custom SSIDs). Enter the SSIDs you want to broadcast (separated by commas). The device will start broadcasting fake networks. Leave it running to catch devices. To stop, go back to the menu or select Stop Karma Attack. Command line\rRun karma start to begin automatic SSID learning. The device will cache SSIDs from probe requests. Or run karma start SSID1 SSID2 SSID3 to use specific SSIDs. Example: karma start FreeWiFi Starbucks McDonald's Run karma stop when you\u0026rsquo;re done. How it works\rAutomatic mode: Karma listens for Wi-Fi probe requests from nearby devices and broadcasts fake networks with the SSIDs they\u0026rsquo;re searching for.\nCustom mode: You specify which SSIDs to broadcast instead of learning them automatically.\nWhen a device connects to a fake network, a captive portal starts automatically to capture credentials.\nTroubleshooting\rFake networks not appearing: Try restarting with karma stop then karma start. No devices connecting: Ensure devices are actually searching for networks. Try moving closer to the ESP32. ","description":"Automatically respond to device probes with fake networks.","permalink":"/latest/wifi/karma/","title":"Karma Attack"},{"content":"GhostESP’s aerial detector watches both Wi-Fi and BLE airspace to find Remote ID beacons, DJI links, and drone-branded networks. It alternates radios so scans run reliably on every ESP32 board.\nOverview\rPhase 1 – Wi-Fi sniffing: Promiscuous capture with channel hopping looks for OpenDroneID NAN frames, DJI OUIs, and drone SSIDs. Phase 2 – BLE scanning: Wi-Fi is suspended so BLE can search for OpenDroneID (UUID 0xFFFA) and DJI advertisements (UUID 0xFFE0). Automatic recovery: When BLE stops, GhostNet AP and STA sessions return without user interaction. Prerequisites\rESP32 board with both Wi-Fi and BLE (ESP32-S2 can only run Wi-Fi phase). Latest GhostESP firmware with aerial detector enabled. Serial, GhostLink display, or WebUI terminal access. Optional GPS for pairing detections with coordinates. How to Use\rVia Terminal\rScan for aerial devices (default 30 seconds): aerialscan 30 Review captured drones: aeriallist Track one device by index or MAC: aerialtrack 0 Stop scanning or tracking at any time: aerialstop Via Display\rOpen the on-device BLE menu. Select Aerial Detector. Choose an action such as Scan Aerial Devices, List Aerial Devices, or Track Aerial Device. Wait for the command to finish in the terminal pane, then review the results card. Note for Flipper app: The Aerial Detector submenu is under the Wi-Fi category (not BLE) in the Flipper UI. On-device displays keep it under BLE.\nWhat Gets Detected\rOpenDroneID Remote ID (ASTM F3411) — Wi-Fi NAN frames and BLE service 0xFFFA decode BasicID, Location, System, SelfID, and OperatorID messages. DJI protocols — MAC OUI matching and BLE service 0xFFE0 flag Mavic, Phantom, Inspire, and other DJI links. Drone SSIDs — Pattern matching for DJI, Parrot, Autel, Skydio, and FPV networks. Telemetry frameworks — Optional MAVLink, FrSky Sport, and CRSF signatures when UART monitoring is enabled. Each device record stores MAC, vendor, RSSI, GPS/altitude (if broadcast), operator position, and flight status so you can triage real aircraft versus test spoofers.\nSpoofing Remote ID for Testing\rUse the spoof workflow to broadcast a test drone and confirm your detector (or another receiver) reacts:\naerialspoof DRONE-TEST 37.7749 -122.4194 120 Sends alternating BasicID and Location frames once per second. Wi-Fi remains suspended until you run aerialspoofstop. Pair a second GhostESP, run aerialscan, and verify it lists DRONE-TEST. Troubleshooting\r“Wi-Fi suspended” message: Normal during BLE phase or spoofing. It clears after the command finishes or you run aerialstop. No detections: Increase scan time (aerialscan 60) so each phase lasts longer, or move closer to the suspected drone. ESP32-S2 board: Only Wi-Fi detections work; BLE phase is skipped. Heap errors during repeated scans: Restart your device ","description":"Detect drones, controllers, and OpenDroneID broadcasts with sequential Wi-Fi/BLE sweeps.","permalink":"/latest/wifi/aerial-detection/","title":"Aerial Detection"},{"content":"Cast random YouTube videos to all DIAL-enabled devices (Chromecasts, smart TVs, Roku, etc.) on your network.\nNote: Only test this on networks and devices you own or have explicit permission to test.\nPrerequisites\rGhostESP flashed device, powered on. Connected to the same Wi-Fi network as the target devices (run connect SSID PASSWORD first). DIAL-enabled devices on the network (Chromecast, smart TV with YouTube app, Roku, etc.). How to use\rOn-device UI\rFirst connect to a Wi-Fi network: Menu → WiFi → Connect. Go to Menu → WiFi → DIAL Connect. The device will discover smart TVs and cast a random YouTube video. Command line\rCast to first available device:\ndialconnect Cast to ALL devices on the network:\ndialconnect all or\ndialconnect -a Set a custom device name (shown on TV):\ndialconnect MyDevice Cast to all with custom name:\ndialconnect all GhostESP What happens\rGhostESP discovers DIAL-enabled devices using SSDP (multicast discovery). For each device found, it fetches the device description to get the app launch URL. It sends a POST request to launch YouTube with a random video ID. The TV should start playing the video within seconds. Supported devices\rDIAL Connect works with any device that supports the DIAL protocol:\nGoogle Chromecast (all versions) Android TV (Sony, Philips, TCL, etc.) Roku devices Samsung Smart TVs (Tizen-based) LG Smart TVs (webOS) Fire TV devices Troubleshooting\rNo devices found: Make sure GhostESP is connected to the same network as your smart TVs. Run connect SSID PASSWORD first. 404 errors: The YouTube app may not be installed or available on that device. 403 errors: The device may have DIAL restrictions enabled. Some Roku devices require enabling \u0026ldquo;Screen Mirroring\u0026rdquo; in settings. Connection timeouts: The device may be on a different subnet or have firewall rules blocking DIAL. How it works\rDIAL (Discovery and Launch) is a protocol developed by Netflix and YouTube that allows second-screen devices to discover and launch apps on first-screen devices (TVs). GhostESP uses this protocol to:\nSend an SSDP M-SEARCH request to discover DIAL devices. Fetch device descriptions to get the Application-URL. POST to the YouTube app endpoint with a video ID parameter. The TV receives the launch request and starts playing the specified video.\n","description":"Cast YouTube videos to smart TVs on your network.","permalink":"/latest/wifi/dial-connect/","title":"DIAL Connect"}]