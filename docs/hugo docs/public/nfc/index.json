[{"content":" Prerequisites GhostESP firmware compiled with NFC support and a connected PN532 module wired to the configured SDA/SCL/IRQ/RST pins. (Optional) SD card if you plan to save tag dumps. Steps Open Scan. Pick Scan in the NFC menu; the popup shows “Scanning NFC\u0026hellip;” while the PN532 spins up.\nBring in a tag. Place it flat on the antenna. The UID, ATQA, and SAK appear immediately; Classic cards flip the title to “Bruteforcing keys… 0%”.\nHold steady. Keep the tag still while reads finish. If the tag slips away, the UI pauses and prompts you to return it before resuming.\nCheck output. Review the summary, toggle More for more info, and use Save to write the dump once “NFC Tag” is displayed.\nAuto-Pause Detection The scanner polls for the tag continuously. If it leaves the field mid-scan, the UI enters a paused state, disables brute-force attempts, and resumes automatically once the same UID is back in range. MIFARE Classic Flow Dictionary attack order. GhostESP authenticates each sector using keys from /mnt/ghostesp/nfc/mfc_user_keys.nfc, then bundled common keys, then the compiled Flipper dictionary. The title bar remains on “Bruteforcing keys…” while this progresses.\nCaching behavior. Once a sector unlocks, its blocks and both Key A/Key B values are cached. The title shifts to “Reading sectors\u0026hellip;” during the copy. Successful keys are appended back to the user dictionary on the SD card.\nMagic backdoor tags. If the card supports the classic backdoor sequence, GhostESP logs the detection and can skip sector authentication, pulling data directly.\nSkip option. Tap Skip to bypass the user and dictionary lists when you only need publicly readable sectors (sector 0).\nAfter the scan. The more summary lists recovered sectors and keys as well as any detected NDEF data.\nNTAG / Ultralight Flow Immediate reads. NTAG21x and Ultralight tags are readable without keys, so the title stays “Scanning NFC\u0026hellip;” until the UID appears, then flips to “NFC Tag”.\nPage sweep. The reader streams all user pages, signature bytes, and counters if present. Progress is shown via the page counter in the popup body.\nNDEF parsing. Detected TLVs are decoded into text, URI, or custom payload summaries. Tap More to see the raw TLV breakdown.\nCaching and saves. All pages remain in RAM for the current session; saving writes the entire image to /mnt/ghostesp/nfc/\u0026lt;Model\u0026gt;_\u0026lt;UID\u0026gt;.nfc for later writes.\nVerification. Re-scan immediately after to confirm the data matches or to check the signature for authenticity.\nVerify Confirm the tag type and UID shown on-screen match the physical tag you scanned. For Mifare Classic cards, check the listed sectors to see how many keys were recovered. If you saved the capture, verify a new \u0026lt;Model\u0026gt;_\u0026lt;UID\u0026gt;.nfc file was created under /mnt/ghostesp/nfc/. Troubleshooting No change from “Scanning NFC\u0026hellip;”. Re-seat the tag and verify PN532 wiring; try another tag to rule out hardware issues.\nStuck on “Bruteforcing keys… 0%”. GhostESP is testing dictionaries. Use the Skip button if you only need publicly readable blocks.\nUID reads but data is empty. The card may be write-protected or needs a key not present in your dictionaries. You can add it to your user dictionary in mnt/ghostesp/nfc/mfc_user_keys.nfc and then try rescanning.\nFAQ Which keys does GhostESP try? Your User Keys list runs first, followed by bundled common keys and then the Flipper Zero Mifare Classic dictionary.\nWhat do the sector labels mean? Mifare Classic memory is split into numbered sectors, each protected by Key A and Key B. A listed sector means at least one key unlocked it during the scan.\nCan I scan other tag families? NTAG21x and Ultralight tags read without needing a brute force; they show their NDEF TLVs immediately after the UID appears.\n","description":"Read GhostESP-compatible NFC tags and understand the on-screen feedback","permalink":"/nfc/scanning/","title":"Scanning"},{"content":" Prerequisites A PN532 enabled build. SD card mounted with free space. Steps Scan a tag. Complete the process in the Scan NFC Tags guide so the popup shows detailed results. You should see the Save button enabled once data is cached.\nTap Save. Select Save in the scan popup. You should see the title change to “Saving\u0026hellip;” and the button disable while GhostESP writes the file.\nWait for confirmation. Leave the device alone until the tit reads \u0026ldquo;Saved!”. You should see the title change if the save fails (for example, “Save Failed!”).\nRepeat as needed. Saved files remain accessible even after you leave the scan popup. You should see the filename follow the pattern \u0026lt;Model\u0026gt;_\u0026lt;UID\u0026gt;.nfc in /mnt/ghostesp/nfc/.\nVerify Browse the SD card and confirm the new file exists with the expected timestamp. Re-open the scan popup and use More to ensure details still match the saved dump. Optional: load the .nfc file in a Flipper Zero to confirm compatibility. Troubleshooting Save button disabled. Re-scan the tag and wait for the title to show “NFC Tag”. “No SD card” error. Check card seating and filesystem. The path /mnt/ghostesp/ must be writeable. File overwriting unexpectedly. GhostESP auto-generates names and will overwrite if the same model/UID combination is scanned repeatedly. FAQ Can I save after removing the tag? Yes. Once the scan completes, the device keeps data in RAM, allowing offline saves. What if the tag is MIFARE Classic? GhostESP saves all recovered sectors and keys, so you can reopen the file later without re-running the dictionary attack. Where are the files stored? Under /mnt/ghostesp/nfc/. ","description":"Store scanned NFC tags as Flipper-compatible files","permalink":"/nfc/saving/","title":"Saving Tags"},{"content":" Prerequisites An NTAG .nfc file on the SD card under /mnt/ghostesp/nfc/ created from a previous scan or copied manually. NTAG21x or Ultralight tag compatible with the captured image size (NTAG213/215/216 page counts). A PN532 enabled build with a connected PN532 module. Steps Open NFC → Write. From the NFC menu, choose Write. You should see a list of .nfc files detected on the SD card.\nSelect an image. Tap the file you want to program. You should see a popup summarizing the tag model, UID (if present), and total pages.\nStart the write. Choose Write in the popup. You should see the status change to “Present tag to write\u0026hellip;” while GhostESP waits for a blank card.\nPresent the blank tag. Hold the target NTAG on the antenna until the title updates. You should see “Writing… X%” as each page is written, finishing at “Write complete”.\nVerify Re-scan the card using the Scan NFC Tags guide to confirm the UID (if applicable) and data match the source image. Check the popup for success messages; any failed page write will trigger an error log with the page number. Optional: load the card in an external reader to confirm the NDEF payload or application data. Troubleshooting File list empty. Ensure .nfc files exist under /mnt/ghostesp/nfc/ and the SD card is mounted.\n“Present tag to write\u0026hellip;” never changes. The PN532 cannot see the card. Re-seat the antenna or try a different blank tag.\nWrite stops mid-way. Remove the tag, power-cycle GhostESP, and retry. Persistent failures often mean the card’s capacity does not match the image (e.g., writing a 216-page dump to a 213 card).\nFAQ Can I clone MIFARE Classic with this flow? No, the Write flow is limited to NTAG/Ultralight dumps today. Do I need to keep holding the card after 100%? Hold it until “Write complete” appears; the device finalizes status after the last page. Will the UID be overwritten? NTAG UIDs are read-only. The saved UID is used for naming and verification, but the physical card keeps its factory UID. ","description":"Program NTAG and Ultralight cards from saved dumps","permalink":"/nfc/writing/","title":"Writing NTAG"},{"content":" Overview GhostESP’s PN532 stack focuses on ISO14443A tags. This page summarizes what the firmware supports today and what the UI exposes for each family.\nNTAG / Ultralight Models: NTAG213 (45 pages), NTAG215 (135 pages), NTAG216 (231 pages), and Ultralight variants with similar memory layouts.\nRead: Full user memory, signature, version, and counter/tearing registers. NDEF TLVs are parsed into human-readable summaries.\nSave: Exports to Flipper .nfc files including UID, header metadata, and all user pages.\nWrite: Supported. GhostESP programs NTAG images back to blank tags, enforcing the original page count before starting.\nNotes: UID is read-only; the saved UID is used for filenames and verification only.\nMIFARE Classic Models: 1K, 4K, Mini (via SAK/ATQA detection).\nRead: Sector-by-sector brute-force with layered keys:\nUser dictionary file on the SD card (/mnt/ghostesp/nfc/mfc_user_keys.nfc), which you will have to edit manually. Built-in common keys. Flipper Zero dictionary pre-compiled in. User Dictionary: Successful keys are appended to the user dictionary on the mounted sd card so future scans start with known values.\nSave: Unlocked sectors and recovered keys are stored in Flipper formatted .nfc files.\nWrite: Not currently supported from GhostESP.\nNotes: UI shows progress as “Bruteforcing keys…” and “Reading sectors…” while blocks are cached. Classic tags with the well-known magic backdoor are detected; when enabled, GhostESP can read blocks without authenticating that sector first.\nOther ISO14443A Detection: GhostESP reports UID, ATQA, SAK, and basic type info for ISO14443A tags that don’t fit the above categories.\nRead/Write: Not implemented beyond basic presence detection.\nNotes: Future firmware updates may expand support; check release notes for changes.\nUnsupported Families MIFARE DESFire / Plus: Not supported. ISO14443B, ISO15693, FeliCa: Not supported by the current PN532 integration. Emulation / Peer-to-Peer: Not supported. ","description":"Reference for NFC tag support in GhostESP","permalink":"/nfc/supported/","title":"Supported Tags"}]